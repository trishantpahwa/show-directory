language: node_js
node_js:
  - "7"
  - "6"
before_install:
  - npm version
jobs:
  include:
    - stage: Compile
      script: npm run build:with-tests
      compile:
        provider: npm
        email: "trishantpahwa@gmail.com"
        on:
          tags: true
          branch: master
    - stage: Tests
      script: npm run build:with-tests && npm test
      test:
        provider: npm
        email: "trishantpahwa@gmail.com"
        on:
          tags: true
          branch: master
    - stage: Clean Compile
      script: npm run build
      clean-compile:
        provider: npm
        email: "trishantpahwa@gmail.com"
        on:
          tags: true
          branch: master
    - stage: Deployment
      node_js: "7"
      script: npm run build && npm run deploy && npx semantic-release
      deploy:
        provider: npm
        email: "trishantpahwa@gmail.com"
        api_key: "f353ca13-29b9-4bfd-871d-ac47b8750ea8"
        on:
          tags: true
          branch: master
stages:
  - Deployment